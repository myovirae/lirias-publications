<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LIRIAS Publications</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    color: #ffffff;
    background: transparent;
  }
  .pub {
    margin-bottom: 1.2em;
  }
  .title a {
    color: #ffffff;
    font-weight: 600;
    text-decoration: underline;
  }
  .meta {
    font-size: 0.9em;
    opacity: 0.85;
  }
</style>
</head>
<body>

<div id="pubs">Loading publications‚Ä¶</div>

<script>
// 1Ô∏è‚É£ Callback function for JSONP
function liriasSearchCallback(result) {
  console.log("JSONP callback fired!", result); // üîπ Debug line

  const container = document.getElementById("pubs");
  container.innerHTML = "";

  if (!result || !result.data || result.data.length === 0) {
    container.textContent = "No publications available.";
    return;
  }

  // Sort by year descending, take 20 most recent
  const pubs = result.data
    .filter(p => p.year)              
    .sort((a, b) => b.year - a.year)
    .slice(0, 20);

  pubs.forEach(pub => {
    const div = document.createElement("div");
    div.className = "pub";

    const title = pub.url
      ? `<a href="${pub.url}" target="_blank" rel="noopener">${pub.title || "Untitled"}</a>`
      : (pub.title || "Untitled");

    const authors = pub.author || "";
    const year = pub.year ? ` ‚Ä¢ ${pub.year}` : "";

    div.innerHTML = `
      <div class="title">${title}</div>
      <div class="meta">${authors}${year}</div>
    `;

    container.appendChild(div);
  });
}

// 2Ô∏è‚É£ JSONP request with cache-buster
const script = document.createElement("script");
script.src =
  "https://services.libis.be/search" +
  "?institution=lirias" +
  "&step=100" +
  "&query=" + encodeURIComponent("vcollection:50000679") +
  "&callback=liriasSearchCallback" +
  "&_=" + new Date().getTime(); // üîπ cache-buster

document.body.appendChild(script);
</script>

</body>
</html>
